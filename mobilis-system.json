{"name":"mobilis","meta_project_name":"parent_account_id","nodes":[{"id":"470d3988-a77a-474e-af91-c7180b9175e0","name":"authcache","type":"Mobilis::Node::Redis","extra_depends_on":[],"models":[]},{"id":"f3ce082d-95ae-4a7c-b130-1016d1093ce6","name":"eventstream","type":"Mobilis::Node::Localstack","extra_depends_on":[],"models":[{"type":"Mobilis::Model::LocalstackSNSSQS","sns":"capability-changes","sqs":["capability-changes"]},{"type":"Mobilis::Model::LocalstackSNSSQS","sns":"group-membership-changes","sqs":["group-membership-changes"]},{"type":"Mobilis::Model::LocalstackSNSSQS","sns":"account-structure-changes","sqs":["account-structure-changes"]}]},{"id":"0a755e57-a2a9-470d-984f-75908b0d96b8","name":"otel-collector","type":"Mobilis::Node::OtelCollector","extra_depends_on":["jaeger"],"models":[]},{"id":"01681f91-8694-4644-a2eb-4a2c7b97f028","name":"grafana","type":"Mobilis::Node::Grafana","extra_depends_on":["prometheus"],"models":[]},{"id":"990d6240-8c47-48db-9e21-e3eb828a2b4e","name":"jaeger","type":"Mobilis::Node::Jaeger","extra_depends_on":[],"models":[]},{"id":"4d68e56f-7b23-4928-8512-6b13b7235f64","name":"prometheus","type":"Mobilis::Node::Prometheus","extra_depends_on":["otel-collector"],"models":[]},{"id":"ddfa2cf9-b79a-4052-b63f-c99792198773","name":"user-db","type":"Mobilis::Node::PostgreSQL","extra_depends_on":[],"models":[]},{"id":"14298a0b-57a4-426a-aabe-12cfda74b003","name":"user-service","type":"Mobilis::Node::Rails","extra_depends_on":["otel-collector"],"models":[{"type":"Mobilis::Model::Rails::GraphQL"},{"type":"Mobilis::Model::File","path":"app/models/user.rb","content":"# frozen_string_literal: true\n\nclass User < ApplicationRecord\nend\n"},{"type":"Mobilis::Model::File","path":"db/migrate/20250714003610_create_users.rb","content":"# frozen_string_literal: true\nclass CreateUsers < ActiveRecord::Migration[8.0]\n  def change\n    create_table :users, id: :uuid do |t|\n      t.uuid :account_id, index: true\n      t.string :email\n      t.string :username\n      t.string :first_name\n      t.string :last_name\n      t.string :middle_name\n      t.string :phone_number\n      t.string :alt_phone\n      t.string :slack_id\n      t.string :avatar_url\n      t.string :linkedin\n      t.string :github\n      t.string :twitter\n      t.string :tshirt_size\n      t.string :pronouns\n      t.string :timezone\n      t.timestamps\n    end\n  end\nend\n"}],"primary_database_id":"ddfa2cf9-b79a-4052-b63f-c99792198773","api_mode":true,"factory_bot_enabled":null,"haml_enabled":null,"rspec_enabled":true,"tailwind_enabled":null,"uuid_primary_keys":null},{"id":"eb192279-da66-444f-937f-daeb79e3ad28","name":"account-db","type":"Mobilis::Node::PostgreSQL","extra_depends_on":[],"models":[]},{"id":"035f9e22-fd9f-4438-9f28-f85b0b421185","name":"account-service","type":"Mobilis::Node::Rails","extra_depends_on":["otel-collector"],"models":[{"type":"Mobilis::Model::Rails::GraphQL"},{"type":"Mobilis::Model::File","path":"db/migrate/20250714003609_create_accounts.rb","content":"# frozen_string_literal: true\nclass CreateAccounts < ActiveRecord::Migration[8.0]\n  def change\n    create_table :accounts, id: :uuid do |t|\n      t.string :name\n      t.uuid :parent_account_id, index: true\n\n      t.timestamps\n    end\n\n    add_foreign_key :accounts, :accounts, column: :parent_account_id\n  end\nend\n"},{"type":"Mobilis::Model::File","path":"app/models/account.rb","content":"# frozen_string_literal: true\n# app/models/account.rb\n\nclass Account < ApplicationRecord\n  belongs_to :parent_account, class_name: \"Account\", optional: true\n  has_many :child_accounts, class_name: \"Account\", foreign_key: :parent_account_id, dependent: :nullify\n  before_validation :assign_default_name, on: :create\n\n  private\n\n  def assign_default_name\n    if name.blank?\n      self.id ||= SecureRandom.uuid\n      self.name = \"Account #{id}\".truncate(36)\n    end\n  end\nend\n"}],"primary_database_id":"eb192279-da66-444f-937f-daeb79e3ad28","api_mode":true,"factory_bot_enabled":null,"haml_enabled":null,"rspec_enabled":true,"tailwind_enabled":null,"uuid_primary_keys":null},{"id":"cf32373b-537f-4818-8af1-34073caf5580","name":"authz-db","type":"Mobilis::Node::PostgreSQL","extra_depends_on":[],"models":[]},{"id":"50ddfff2-3345-4520-855b-59cf51f00ced","name":"authorization-service","type":"Mobilis::Node::Rails","extra_depends_on":["authcache","otel-collector"],"models":[{"type":"Mobilis::Model::Rails::GraphQL"},{"type":"Mobilis::Model::File","path":"db/migrate/20250714003611_create_capabilities.rb","content":"# frozen_string_literal: true\nclass CreateCapabilities < ActiveRecord::Migration[8.0]\n  def change\n    create_table :capabilities, id: :uuid do |t|\n      t.uuid :subject_id, index: true\n      t.uuid :account_id, index: true\n      t.string :permission\n      t.timestamps\n    end\n  end\nend\n"}],"primary_database_id":"cf32373b-537f-4818-8af1-34073caf5580","api_mode":true,"factory_bot_enabled":null,"haml_enabled":null,"rspec_enabled":true,"tailwind_enabled":null,"uuid_primary_keys":null},{"id":"ba3607fc-d523-45b4-aaa4-527af3af7653","name":"organization-db","type":"Mobilis::Node::PostgreSQL","extra_depends_on":[],"models":[]},{"id":"32264b04-4782-4f15-8b27-79724dcaee8c","name":"organization-service","type":"Mobilis::Node::Rails","extra_depends_on":[],"models":[{"type":"Mobilis::Model::Rails::GraphQL"}],"primary_database_id":"ba3607fc-d523-45b4-aaa4-527af3af7653","api_mode":true,"factory_bot_enabled":null,"haml_enabled":null,"rspec_enabled":null,"tailwind_enabled":null,"uuid_primary_keys":null},{"id":"d3de6cdd-7a3b-41d6-9ada-3a9b26679037","name":"user-management-service","type":"Mobilis::Node::Rails","extra_depends_on":["otel-collector","user-service","account-service","authorization-service","organization-service"],"models":[{"type":"Mobilis::Model::Rails::GraphQL"},{"type":"Mobilis::Model::File","path":"scripts/setup.sh","content":"#!/bin/bash\nbundle add activeresource --require active_resource\n"},{"type":"Mobilis::Model::File","path":"scripts/create_user.rb","content":"# frozen_string_literal: true\n\n# app/models/user.rb\nclass User < ActiveResource::Base\n  self.site = ENV.fetch(\"USER_API_BASE_URL\") # e.g., http://user-service:3000/\n  self.format = :json\n\n  # Optional: if the resource uses UUIDs instead of integers\n  self.primary_key = \"id\"\n\n  # Optional: if user-service uses a different collection path\n  self.collection_name = \"users\"\n\n  # Optional: handle nested resources, errors, etc.\nend\n"},{"type":"Mobilis::Model::File","path":"scripts/create_user.rb","content":"User.create(name: \"bleh\")\n"}],"api_mode":false,"factory_bot_enabled":null,"haml_enabled":null,"rspec_enabled":true,"tailwind_enabled":true,"uuid_primary_keys":null}]}